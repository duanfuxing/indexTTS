[unix_http_server]
file=/root/autodl-tmp/index-tts-vllm/logs/supervisor.sock   ; 项目特定的supervisor socket文件路径
chmod=0700                       ; socket文件权限

[supervisord]
logfile=/root/autodl-tmp/index-tts-vllm/logs/supervisord.log ; 主日志文件
logfile_maxbytes=50MB            ; 日志文件最大大小
logfile_backups=10               ; 日志文件备份数量
loglevel=info                    ; 日志级别
pidfile=/root/autodl-tmp/index-tts-vllm/logs/supervisord.pid ; PID文件
nodaemon=false                   ; 是否在前台运行
minfds=1024                      ; 最小文件描述符数量
minprocs=200                     ; 最小进程数量

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///root/autodl-tmp/index-tts-vllm/logs/supervisor.sock ; 使用项目特定的unix socket连接

[group:tts-services]
programs=tts-api-server,tts-task-worker
priority=999

; TTS API服务器配置
[program:tts-api-server]
command=/root/autodl-tmp/conda_envs/index-tts-vllm/bin/python server/api_server.py  ; 启动命令
directory=/root/autodl-tmp/index-tts-vllm     ; 工作目录
user=root                 ; 运行用户
autostart=true       ; 是否自动启动
autorestart=true   ; 是否自动重启
startsecs=10       ; 启动后等待时间（秒）
startretries=3 ; 启动失败重试次数
redirect_stderr=true                         ; 重定向错误输出到标准输出
stdout_logfile=/root/autodl-tmp/index-tts-vllm/logs/api_server.log           ; 标准输出日志文件
stdout_logfile_maxbytes=50MB                     ; 日志文件最大大小
stdout_logfile_backups=10                       ; 日志文件备份数量
stderr_logfile=/root/autodl-tmp/index-tts-vllm/logs/api_server_error.log     ; 错误输出日志文件
stderr_logfile_maxbytes=50MB                     ; 错误日志文件最大大小
stderr_logfile_backups=10                       ; 错误日志文件备份数量
priority=100                                    ; 进程优先级

; TTS任务处理器配置
[program:tts-task-worker]
command=/root/autodl-tmp/conda_envs/index-tts-vllm/bin/python server/task_worker.py  ; 任务处理器启动命令
directory=/root/autodl-tmp/index-tts-vllm     ; 工作目录
user=root                 ; 运行用户
autostart=true       ; 是否自动启动
autorestart=true   ; 是否自动重启
startsecs=10       ; 启动后等待时间（秒）
startretries=3 ; 启动失败重试次数
redirect_stderr=true                         ; 重定向错误输出到标准输出
stdout_logfile=/root/autodl-tmp/index-tts-vllm/logs/worker_long.log           ; 标准输出日志文件
stdout_logfile_maxbytes=50MB                     ; 日志文件最大大小
stdout_logfile_backups=10                       ; 日志文件备份数量
stderr_logfile=/root/autodl-tmp/index-tts-vllm/logs/worker_long_error.log     ; 错误输出日志文件
stderr_logfile_maxbytes=50MB                     ; 错误日志文件最大大小
stderr_logfile_backups=10                       ; 错误日志文件备份数量
priority=200                                 ; 进程优先级
[group:tts-services]
programs=tts-api-server,tts-task-worker  ; 包含的程序列表：API服务器、任务处理器