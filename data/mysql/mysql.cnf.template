[client]
host=${MYSQL_HOST:-localhost}
port=${MYSQL_PORT:-3306}
user=${MYSQL_USER:-tts_user}
password=${MYSQL_PASSWORD:-tts_password}
database=${MYSQL_DATABASE:-tts_db}
default-character-set=utf8mb4

[mysql]
default-character-set=utf8mb4

[mysqld]
# 基本配置
port=${MYSQL_PORT:-3306}
bind-address=127.0.0.1
datadir=${MYSQL_DATA_DIR}
socket=${MYSQL_DATA_DIR}/mysql.sock
pid-file=${MYSQL_DATA_DIR}/mysql.pid
tmpdir=${MYSQL_DATA_DIR}/tmp

# 字符集和时区
character-set-server=utf8mb4
collation-server=utf8mb4_unicode_ci
default-time-zone='+8:00'
init-connect='SET NAMES utf8mb4'

# 连接配置
max_connections=200
max_connect_errors=100000
connect_timeout=10
wait_timeout=28800
interactive_timeout=28800
back_log=300

# 内存配置
innodb_buffer_pool_size=128M
innodb_buffer_pool_instances=1
key_buffer_size=16M
query_cache_size=0
query_cache_type=0
sort_buffer_size=2M
read_buffer_size=128K
read_rnd_buffer_size=256K
join_buffer_size=128K
tmp_table_size=16M
max_heap_table_size=16M

# InnoDB配置
innodb_file_per_table=1
innodb_flush_log_at_trx_commit=1
innodb_log_buffer_size=8M
innodb_log_file_size=48M
innodb_log_files_in_group=2
innodb_flush_method=O_DIRECT
innodb_lock_wait_timeout=50
innodb_io_capacity=200
innodb_io_capacity_max=2000
innodb_read_io_threads=4
innodb_write_io_threads=4
innodb_purge_threads=1
innodb_thread_concurrency=0

# 日志配置
log_error=${MYSQL_DATA_DIR}/error.log
slow_query_log=1
slow_query_log_file=${MYSQL_DATA_DIR}/slow.log
long_query_time=2
log_queries_not_using_indexes=0
log_slow_admin_statements=0
log_slow_slave_statements=0

# 二进制日志配置
log_bin=${MYSQL_DATA_DIR}/mysql-bin
binlog_format=ROW
binlog_cache_size=32K
max_binlog_size=100M
expire_logs_days=7
sync_binlog=1

# 安全配置
skip_name_resolve=1
local_infile=0
secure_file_priv=
sql_mode=STRICT_TRANS_TABLES,NO_ZERO_DATE,NO_ZERO_IN_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION

# 性能优化
table_open_cache=2000
table_definition_cache=1400
thread_cache_size=8
thread_stack=192K
max_allowed_packet=16M
bulk_insert_buffer_size=8M
myisam_sort_buffer_size=8M
myisam_max_sort_file_size=10G
myisam_repair_threads=1

# 复制配置
server_id=1
relay_log=${MYSQL_DATA_DIR}/relay-bin
relay_log_recovery=1
slave_skip_errors=

[mysqldump]
quick
quote-names
max_allowed_packet=16M

[mysql]
no-auto-rehash
default-character-set=utf8mb4

[myisamchk]
key_buffer_size=20M
sort_buffer_size=20M
read_buffer=2M
write_buffer=2M

[mysqlhotcopy]
interactive-timeout