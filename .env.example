# ===========================================
# 数据库配置 (必须配置)
# ===========================================
# MySQL数据库配置
MYSQL_HOST=
MYSQL_PORT=
MYSQL_USER=
MYSQL_PASSWORD=
MYSQL_DATABASE=

# Redis配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_QUEUE_PREFIX=tts_queue

# ===========================================
# TTS模型配置 (必须配置)
# ===========================================
# TTS模型目录路径，请修改为实际路径
MODEL_DIR=/path/to/IndexTeam/Index-TTS
# GPU内存使用率 (0.1-1.0)，建议根据显卡内存调整
GPU_MEMORY_UTILIZATION=0.80
# 模型最大序列长度，影响处理的文本长度上限
MAX_MODEL_LEN=2048
# 张量并行大小，多GPU时可设置为GPU数量
TENSOR_PARALLEL_SIZE=1

# ===========================================
# 服务器配置
# ===========================================
# 服务器监听地址，0.0.0.0表示监听所有网卡，127.0.0.1仅本地访问
HOST=0.0.0.0
# 服务器端口，确保端口未被占用
PORT=6006
# 工作进程数量，建议设置为CPU核心数
WORKERS=1

# ===========================================
# 文件存储配置
# ===========================================
# 音频文件输出目录，生成的音频文件保存路径
AUDIO_OUTPUT_DIR=./storage/audio
# 文本内容存储的根目录路径，每个任务会在此目录下创建子目录
TEXT_STORAGE_DIR=./storage/tasks
# SRT字幕文件的输出目录路径
SRT_OUTPUT_DIR=./storage/srt


# TOS对象存储配置 (可选，用于文件上传到云存储)
# 如果不配置，文件将只保存在本地
TOS_ACCESS_KEY=
TOS_SECRET_KEY=
TOS_ENDPOINT=
TOS_REGION=
TOS_BUCKET=
TOS_REMOTE_PATH=

# ===========================================
# 任务配置
# ===========================================
# 在线TTS最大文本长度（字符数），超过此长度将转为异步处理
MAX_ONLINE_TEXT_LENGTH=300
# 长文本TTS最大文本长度（字符数），超过此长度将被拒绝
MAX_LONG_TEXT_LENGTH=50000
# 任务超时时间（秒），超时任务将被终止
TASK_TIMEOUT=300
# 最大并发任务数，控制同时处理的TTS任务数量
MAX_CONCURRENT_TASKS=10

# ===========================================
# 队列配置
# ===========================================
# 普通任务队列最大长度，超过将拒绝新任务
QUEUE_MAX_SIZE=1000
# 高优先级任务队列最大长度
HIGH_PRIORITY_QUEUE_MAX_SIZE=100
# 任务失败时的最大重试次数
TASK_RETRY_MAX_ATTEMPTS=3

# ===========================================
# 缓存配置
# ===========================================
# 通用缓存过期时间（秒）
CACHE_TTL=3600
# 语音配置缓存过期时间（秒），语音模型配置缓存时长
VOICE_CONFIG_CACHE_TTL=7200
# 任务状态缓存过期时间（秒），任务状态查询缓存时长
TASK_STATUS_CACHE_TTL=300

# ===========================================
# 处理器配置
# ===========================================
# 处理器轮询间隔（秒），任务处理器检查新任务的频率
WORKER_POLL_INTERVAL=1.0
# 最大重试次数，任务失败后的重试上限
MAX_RETRY_COUNT=3

# ===========================================
# 日志配置
# ===========================================
# 日志级别: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO
LOG_FILE=./logs/tts_service.log
LOG_MAX_SIZE=10MB
LOG_BACKUP_COUNT=5

# ===========================================
# 安全配置 (可选)
# ===========================================
# API密钥，如果设置则需要在请求头中提供
# API_KEY=your_secret_api_key_here
# 允许的跨域来源，多个用逗号分隔，*表示允许所有来源
ALLOWED_ORIGINS=*
# 每分钟请求限制数，防止API滥用
RATE_LIMIT_PER_MINUTE=60

# ===========================================
# 监控配置 (可选)
# ===========================================
# 是否启用监控指标，开启后可通过/metrics端点查看系统指标
ENABLE_METRICS=false
# 监控服务端口，Prometheus指标收集端口
METRICS_PORT=8000

# ===========================================
# 清理配置
# ===========================================
# 清理多少天前的旧任务，自动删除过期任务记录
CLEANUP_OLD_TASKS_DAYS=7
# 清理任务的执行间隔（小时），定期清理任务的频率
CLEANUP_INTERVAL_HOURS=24

# ===========================================
# Supervisor进程管理配置
# ===========================================
# 进程自动启动设置
SUPERVISOR_AUTOSTART=true
# 进程自动重启设置
SUPERVISOR_AUTORESTART=true
# 进程启动后等待时间（秒），判断进程是否成功启动
SUPERVISOR_STARTSECS=10
# 进程启动失败时的重试次数
SUPERVISOR_STARTRETRIES=3
# 日志文件最大大小
SUPERVISOR_LOG_MAXBYTES=50MB
# 日志文件备份数量
SUPERVISOR_LOG_BACKUPS=10
# TTS API服务器进程优先级
SUPERVISOR_TTS_API_PRIORITY=100
# TTS任务处理器进程优先级
SUPERVISOR_TTS_WORKER_PRIORITY=90
# 进程运行用户（Ubuntu环境）
SUPERVISOR_USER=www-data
# 项目部署目录（Ubuntu环境）
SUPERVISOR_PROJECT_DIR=/opt/index-tts-vllm

